{"version":3,"sources":["deps/phoenix/web/static/js/phoenix.js","deps/phoenix_html/web/static/js/phoenix_html.js","web/static/js/app.js","web/static/js/socket.js"],"names":["VSN","SOCKET_STATES","connecting","open","closing","closed","DEFAULT_TIMEOUT","CHANNEL_STATES","errored","joined","joining","leaving","CHANNEL_EVENTS","close","error","join","reply","leave","TRANSPORTS","longpoll","websocket","Push","channel","event","payload","timeout","receivedResp","timeoutTimer","recHooks","sent","cancelRefEvent","ref","refEvent","send","hasReceived","startTimeout","socket","push","topic","status","callback","response","filter","h","forEach","off","clearTimeout","makeRef","replyEventName","on","cancelTimeout","matchReceive","setTimeout","trigger","Channel","params","state","bindings","joinedOnce","joinPush","pushBuffer","rejoinTimer","Timer","rejoinUntilConnected","reconnectAfterMs","receive","reset","pushEvent","onClose","log","joinRef","remove","onError","isLeaving","isClosed","reason","scheduleTimeout","isJoining","isConnected","rejoin","bind","isJoined","canPush","leavePush","resend","sendJoin","indexOf","handledPayload","onMessage","map","Socket","endPoint","opts","stateChangeCallbacks","message","channels","sendBuffer","transport","window","WebSocket","LongPoll","heartbeatIntervalMs","tries","logger","longpollerTimeout","reconnectTimer","disconnect","connect","location","protocol","match","uri","Ajax","appendParams","vsn","charAt","host","code","conn","onclose","console","endPointURL","onopen","onConnOpen","onerror","onConnError","onmessage","onConnMessage","onConnClose","kind","msg","data","prototype","flushSendBuffer","skipHeartbeat","clearInterval","heartbeatTimer","setInterval","sendHeartbeat","triggerChanError","readyState","connectionState","c","chanParams","chan","JSON","stringify","newRef","toString","length","rawMessage","parse","isMember","token","pollEndpoint","normalizeEndpoint","poll","replace","RegExp","closeAndRetry","request","endpointURL","ontimeout","resp","messages","body","method","accept","XDomainRequest","req","xdomainRequest","XMLHttpRequest","ActiveXObject","xhrRequest","onload","parseJSON","responseText","onprogress","setRequestHeader","onreadystatechange","states","complete","obj","parentKey","queryStr","key","hasOwnProperty","paramKey","paramVal","serialize","encodeURIComponent","url","Object","keys","prefix","Presence","syncState","currentState","newState","onJoin","onLeave","clone","joins","leaves","presence","newPresence","currentPresence","newRefs","metas","m","phx_ref","curRefs","joinedMetas","leftMetas","syncDiff","unshift","leftPresence","refsToRemove","p","list","presences","chooser","pres","func","getOwnPropertyNames","timerCalc","timer","isLinkToSubmitParent","element","isLinkTag","tagName","shouldSubmitParent","getAttribute","didHandleSubmitLinkClick","confirm","parentNode","submit","addEventListener","target","preventDefault"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAMA,MAAM,OAAZ;AACA,IAAMC,gBAAgB,EAACC,YAAY,CAAb,EAAgBC,MAAM,CAAtB,EAAyBC,SAAS,CAAlC,EAAqCC,QAAQ,CAA7C,EAAtB;AACA,IAAMC,kBAAkB,KAAxB;AACA,IAAMC,iBAAiB;AACrBF,UAAQ,QADa;AAErBG,WAAS,SAFY;AAGr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","file":"priv/static/js/app.js","sourcesContent":["// Phoenix Channels JavaScript client\n//\n// ## Socket Connection\n//\n// A single connection is established to the server and\n// channels are multiplexed over the connection.\n// Connect to the server using the `Socket` class:\n//\n//     let socket = new Socket(\"/ws\", {params: {userToken: \"123\"}})\n//     socket.connect()\n//\n// The `Socket` constructor takes the mount point of the socket,\n// the authentication params, as well as options that can be found in\n// the Socket docs, such as configuring the `LongPoll` transport, and\n// heartbeat.\n//\n// ## Channels\n//\n// Channels are isolated, concurrent processes on the server that\n// subscribe to topics and broker events between the client and server.\n// To join a channel, you must provide the topic, and channel params for\n// authorization. Here's an example chat room example where `\"new_msg\"`\n// events are listened for, messages are pushed to the server, and\n// the channel is joined with ok/error/timeout matches:\n//\n//     let channel = socket.channel(\"room:123\", {token: roomToken})\n//     channel.on(\"new_msg\", msg => console.log(\"Got message\", msg) )\n//     $input.onEnter( e => {\n//       channel.push(\"new_msg\", {body: e.target.val}, 10000)\n//        .receive(\"ok\", (msg) => console.log(\"created message\", msg) )\n//        .receive(\"error\", (reasons) => console.log(\"create failed\", reasons) )\n//        .receive(\"timeout\", () => console.log(\"Networking issue...\") )\n//     })\n//     channel.join()\n//       .receive(\"ok\", ({messages}) => console.log(\"catching up\", messages) )\n//       .receive(\"error\", ({reason}) => console.log(\"failed join\", reason) )\n//       .receive(\"timeout\", () => console.log(\"Networking issue. Still waiting...\") )\n//\n//\n// ## Joining\n//\n// Creating a channel with `socket.channel(topic, params)`, binds the params to\n// `channel.params`, which are sent up on `channel.join()`.\n// Subsequent rejoins will send up the modified params for\n// updating authorization params, or passing up last_message_id information.\n// Successful joins receive an \"ok\" status, while unsuccessful joins\n// receive \"error\".\n//\n// ## Duplicate Join Subscriptions\n//\n// While the client may join any number of topics on any number of channels,\n// the client may only hold a single subscription for each unique topic at any\n// given time. When attempting to create a duplicate subscription,\n// the server will close the existing channel, log a warning, and\n// spawn a new channel for the topic. The client will have their\n// `channel.onClose` callbacks fired for the existing channel, and the new\n// channel join will have its receive hooks processed as normal.\n//\n// ## Pushing Messages\n//\n// From the previous example, we can see that pushing messages to the server\n// can be done with `channel.push(eventName, payload)` and we can optionally\n// receive responses from the push. Additionally, we can use\n// `receive(\"timeout\", callback)` to abort waiting for our other `receive` hooks\n//  and take action after some period of waiting. The default timeout is 5000ms.\n//\n//\n// ## Socket Hooks\n//\n// Lifecycle events of the multiplexed connection can be hooked into via\n// `socket.onError()` and `socket.onClose()` events, ie:\n//\n//     socket.onError( () => console.log(\"there was an error with the connection!\") )\n//     socket.onClose( () => console.log(\"the connection dropped\") )\n//\n//\n// ## Channel Hooks\n//\n// For each joined channel, you can bind to `onError` and `onClose` events\n// to monitor the channel lifecycle, ie:\n//\n//     channel.onError( () => console.log(\"there was an error!\") )\n//     channel.onClose( () => console.log(\"the channel has gone away gracefully\") )\n//\n// ### onError hooks\n//\n// `onError` hooks are invoked if the socket connection drops, or the channel\n// crashes on the server. In either case, a channel rejoin is attempted\n// automatically in an exponential backoff manner.\n//\n// ### onClose hooks\n//\n// `onClose` hooks are invoked only in two cases. 1) the channel explicitly\n// closed on the server, or 2). The client explicitly closed, by calling\n// `channel.leave()`\n//\n//\n// ## Presence\n//\n// The `Presence` object provides features for syncing presence information\n// from the server with the client and handling presences joining and leaving.\n//\n// ### Syncing initial state from the server\n//\n// `Presence.syncState` is used to sync the list of presences on the server\n// with the client's state. An optional `onJoin` and `onLeave` callback can\n// be provided to react to changes in the client's local presences across\n// disconnects and reconnects with the server.\n//\n// `Presence.syncDiff` is used to sync a diff of presence join and leave\n// events from the server, as they happen. Like `syncState`, `syncDiff`\n// accepts optional `onJoin` and `onLeave` callbacks to react to a user\n// joining or leaving from a device.\n//\n// ### Listing Presences\n//\n// `Presence.list` is used to return a list of presence information\n// based on the local state of metadata. By default, all presence\n// metadata is returned, but a `listBy` function can be supplied to\n// allow the client to select which metadata to use for a given presence.\n// For example, you may have a user online from different devices with a\n// a metadata status of \"online\", but they have set themselves to \"away\"\n// on another device. In this case, they app may choose to use the \"away\"\n// status for what appears on the UI. The example below defines a `listBy`\n// function which prioritizes the first metadata which was registered for\n// each user. This could be the first tab they opened, or the first device\n// they came online from:\n//\n//     let state = {}\n//     state = Presence.syncState(state, stateFromServer)\n//     let listBy = (id, {metas: [first, ...rest]}) => {\n//       first.count = rest.length + 1 // count of this user's presences\n//       first.id = id\n//       return first\n//     }\n//     let onlineUsers = Presence.list(state, listBy)\n//\n//\n// ### Example Usage\n//\n//     // detect if user has joined for the 1st time or from another tab/device\n//     let onJoin = (id, current, newPres) => {\n//       if(!current){\n//         console.log(\"user has entered for the first time\", newPres)\n//       } else {\n//         console.log(\"user additional presence\", newPres)\n//       }\n//     }\n//     // detect if user has left from all tabs/devices, or is still present\n//     let onLeave = (id, current, leftPres) => {\n//       if(current.metas.length === 0){\n//         console.log(\"user has left from all devices\", leftPres)\n//       } else {\n//         console.log(\"user left from a device\", leftPres)\n//       }\n//     }\n//     let presences = {} // client's initial empty presence state\n//     // receive initial presence data from server, sent after join\n//     myChannel.on(\"presences\", state => {\n//       presences = Presence.syncState(presences, state, onJoin, onLeave)\n//       displayUsers(Presence.list(presences))\n//     })\n//     // receive \"presence_diff\" from server, containing join/leave events\n//     myChannel.on(\"presence_diff\", diff => {\n//       presences = Presence.syncDiff(presences, diff, onJoin, onLeave)\n//       this.setState({users: Presence.list(room.presences, listBy)})\n//     })\n//\nconst VSN = \"1.0.0\"\nconst SOCKET_STATES = {connecting: 0, open: 1, closing: 2, closed: 3}\nconst DEFAULT_TIMEOUT = 10000\nconst CHANNEL_STATES = {\n  closed: \"closed\",\n  errored: \"errored\",\n  joined: \"joined\",\n  joining: \"joining\",\n  leaving: \"leaving\",\n}\nconst CHANNEL_EVENTS = {\n  close: \"phx_close\",\n  error: \"phx_error\",\n  join: \"phx_join\",\n  reply: \"phx_reply\",\n  leave: \"phx_leave\"\n}\nconst TRANSPORTS = {\n  longpoll: \"longpoll\",\n  websocket: \"websocket\"\n}\n\nclass Push {\n\n  // Initializes the Push\n  //\n  // channel - The Channel\n  // event - The event, for example `\"phx_join\"`\n  // payload - The payload, for example `{user_id: 123}`\n  // timeout - The push timeout in milliseconds\n  //\n  constructor(channel, event, payload, timeout){\n    this.channel      = channel\n    this.event        = event\n    this.payload      = payload || {}\n    this.receivedResp = null\n    this.timeout      = timeout\n    this.timeoutTimer = null\n    this.recHooks     = []\n    this.sent         = false\n  }\n\n  resend(timeout){\n    this.timeout = timeout\n    this.cancelRefEvent()\n    this.ref          = null\n    this.refEvent     = null\n    this.receivedResp = null\n    this.sent         = false\n    this.send()\n  }\n\n  send(){ if(this.hasReceived(\"timeout\")){ return }\n    this.startTimeout()\n    this.sent = true\n    this.channel.socket.push({\n      topic: this.channel.topic,\n      event: this.event,\n      payload: this.payload,\n      ref: this.ref\n    })\n  }\n\n  receive(status, callback){\n    if(this.hasReceived(status)){\n      callback(this.receivedResp.response)\n    }\n\n    this.recHooks.push({status, callback})\n    return this\n  }\n\n\n  // private\n\n  matchReceive({status, response, ref}){\n    this.recHooks.filter( h => h.status === status )\n                 .forEach( h => h.callback(response) )\n  }\n\n  cancelRefEvent(){ if(!this.refEvent){ return }\n    this.channel.off(this.refEvent)\n  }\n\n  cancelTimeout(){\n    clearTimeout(this.timeoutTimer)\n    this.timeoutTimer = null\n  }\n\n  startTimeout(){ if(this.timeoutTimer){ return }\n    this.ref      = this.channel.socket.makeRef()\n    this.refEvent = this.channel.replyEventName(this.ref)\n\n    this.channel.on(this.refEvent, payload => {\n      this.cancelRefEvent()\n      this.cancelTimeout()\n      this.receivedResp = payload\n      this.matchReceive(payload)\n    })\n\n    this.timeoutTimer = setTimeout(() => {\n      this.trigger(\"timeout\", {})\n    }, this.timeout)\n  }\n\n  hasReceived(status){\n    return this.receivedResp && this.receivedResp.status === status\n  }\n\n  trigger(status, response){\n    this.channel.trigger(this.refEvent, {status, response})\n  }\n}\n\nexport class Channel {\n  constructor(topic, params, socket) {\n    this.state       = CHANNEL_STATES.closed\n    this.topic       = topic\n    this.params      = params || {}\n    this.socket      = socket\n    this.bindings    = []\n    this.timeout     = this.socket.timeout\n    this.joinedOnce  = false\n    this.joinPush    = new Push(this, CHANNEL_EVENTS.join, this.params, this.timeout)\n    this.pushBuffer  = []\n    this.rejoinTimer  = new Timer(\n      () => this.rejoinUntilConnected(),\n      this.socket.reconnectAfterMs\n    )\n    this.joinPush.receive(\"ok\", () => {\n      this.state = CHANNEL_STATES.joined\n      this.rejoinTimer.reset()\n      this.pushBuffer.forEach( pushEvent => pushEvent.send() )\n      this.pushBuffer = []\n    })\n    this.onClose( () => {\n      this.rejoinTimer.reset()\n      this.socket.log(\"channel\", `close ${this.topic} ${this.joinRef()}`)\n      this.state = CHANNEL_STATES.closed\n      this.socket.remove(this)\n    })\n    this.onError( reason => { if(this.isLeaving() || this.isClosed()){ return }\n      this.socket.log(\"channel\", `error ${this.topic}`, reason)\n      this.state = CHANNEL_STATES.errored\n      this.rejoinTimer.scheduleTimeout()\n    })\n    this.joinPush.receive(\"timeout\", () => { if(!this.isJoining()){ return }\n      this.socket.log(\"channel\", `timeout ${this.topic}`, this.joinPush.timeout)\n      this.state = CHANNEL_STATES.errored\n      this.rejoinTimer.scheduleTimeout()\n    })\n    this.on(CHANNEL_EVENTS.reply, (payload, ref) => {\n      this.trigger(this.replyEventName(ref), payload)\n    })\n  }\n\n  rejoinUntilConnected(){\n    this.rejoinTimer.scheduleTimeout()\n    if(this.socket.isConnected()){\n      this.rejoin()\n    }\n  }\n\n  join(timeout = this.timeout){\n    if(this.joinedOnce){\n      throw(`tried to join multiple times. 'join' can only be called a single time per channel instance`)\n    } else {\n      this.joinedOnce = true\n      this.rejoin(timeout)\n      return this.joinPush\n    }\n  }\n\n  onClose(callback){ this.on(CHANNEL_EVENTS.close, callback) }\n\n  onError(callback){\n    this.on(CHANNEL_EVENTS.error, reason => callback(reason) )\n  }\n\n  on(event, callback){ this.bindings.push({event, callback}) }\n\n  off(event){ this.bindings = this.bindings.filter( bind => bind.event !== event ) }\n\n  canPush(){ return this.socket.isConnected() && this.isJoined() }\n\n  push(event, payload, timeout = this.timeout){\n    if(!this.joinedOnce){\n      throw(`tried to push '${event}' to '${this.topic}' before joining. Use channel.join() before pushing events`)\n    }\n    let pushEvent = new Push(this, event, payload, timeout)\n    if(this.canPush()){\n      pushEvent.send()\n    } else {\n      pushEvent.startTimeout()\n      this.pushBuffer.push(pushEvent)\n    }\n\n    return pushEvent\n  }\n\n  // Leaves the channel\n  //\n  // Unsubscribes from server events, and\n  // instructs channel to terminate on server\n  //\n  // Triggers onClose() hooks\n  //\n  // To receive leave acknowledgements, use the a `receive`\n  // hook to bind to the server ack, ie:\n  //\n  //     channel.leave().receive(\"ok\", () => alert(\"left!\") )\n  //\n  leave(timeout = this.timeout){\n    this.state = CHANNEL_STATES.leaving\n    let onClose = () => {\n      this.socket.log(\"channel\", `leave ${this.topic}`)\n      this.trigger(CHANNEL_EVENTS.close, \"leave\", this.joinRef())\n    }\n    let leavePush = new Push(this, CHANNEL_EVENTS.leave, {}, timeout)\n    leavePush.receive(\"ok\", () => onClose() )\n             .receive(\"timeout\", () => onClose() )\n    leavePush.send()\n    if(!this.canPush()){ leavePush.trigger(\"ok\", {}) }\n\n    return leavePush\n  }\n\n  // Overridable message hook\n  //\n  // Receives all events for specialized message handling\n  // before dispatching to the channel callbacks.\n  //\n  // Must return the payload, modified or unmodified\n  onMessage(event, payload, ref){ return payload }\n\n  // private\n\n  isMember(topic){ return this.topic === topic }\n\n  joinRef(){ return this.joinPush.ref }\n\n  sendJoin(timeout){\n    this.state = CHANNEL_STATES.joining\n    this.joinPush.resend(timeout)\n  }\n\n  rejoin(timeout = this.timeout){ if(this.isLeaving()){ return }\n    this.sendJoin(timeout)\n  }\n\n  trigger(event, payload, ref){\n    let {close, error, leave, join} = CHANNEL_EVENTS\n    if(ref && [close, error, leave, join].indexOf(event) >= 0 && ref !== this.joinRef()){\n      return\n    }\n    let handledPayload = this.onMessage(event, payload, ref)\n    if(payload && !handledPayload){ throw(\"channel onMessage callbacks must return the payload, modified or unmodified\") }\n\n    this.bindings.filter( bind => bind.event === event)\n                 .map( bind => bind.callback(handledPayload, ref))\n  }\n\n  replyEventName(ref){ return `chan_reply_${ref}` }\n\n  isClosed() { return this.state === CHANNEL_STATES.closed }\n  isErrored(){ return this.state === CHANNEL_STATES.errored }\n  isJoined() { return this.state === CHANNEL_STATES.joined }\n  isJoining(){ return this.state === CHANNEL_STATES.joining }\n  isLeaving(){ return this.state === CHANNEL_STATES.leaving }\n}\n\nexport class Socket {\n\n  // Initializes the Socket\n  //\n  // endPoint - The string WebSocket endpoint, ie, \"ws://example.com/ws\",\n  //                                               \"wss://example.com\"\n  //                                               \"/ws\" (inherited host & protocol)\n  // opts - Optional configuration\n  //   transport - The Websocket Transport, for example WebSocket or Phoenix.LongPoll.\n  //               Defaults to WebSocket with automatic LongPoll fallback.\n  //   timeout - The default timeout in milliseconds to trigger push timeouts.\n  //             Defaults `DEFAULT_TIMEOUT`\n  //   heartbeatIntervalMs - The millisec interval to send a heartbeat message\n  //   reconnectAfterMs - The optional function that returns the millsec\n  //                      reconnect interval. Defaults to stepped backoff of:\n  //\n  //     function(tries){\n  //       return [1000, 5000, 10000][tries - 1] || 10000\n  //     }\n  //\n  //   logger - The optional function for specialized logging, ie:\n  //     `logger: (kind, msg, data) => { console.log(`${kind}: ${msg}`, data) }\n  //\n  //   longpollerTimeout - The maximum timeout of a long poll AJAX request.\n  //                        Defaults to 20s (double the server long poll timer).\n  //\n  //   params - The optional params to pass when connecting\n  //\n  // For IE8 support use an ES5-shim (https://github.com/es-shims/es5-shim)\n  //\n  constructor(endPoint, opts = {}){\n    this.stateChangeCallbacks = {open: [], close: [], error: [], message: []}\n    this.channels             = []\n    this.sendBuffer           = []\n    this.ref                  = 0\n    this.timeout              = opts.timeout || DEFAULT_TIMEOUT\n    this.transport            = opts.transport || window.WebSocket || LongPoll\n    this.heartbeatIntervalMs  = opts.heartbeatIntervalMs || 30000\n    this.reconnectAfterMs     = opts.reconnectAfterMs || function(tries){\n      return [1000, 2000, 5000, 10000][tries - 1] || 10000\n    }\n    this.logger               = opts.logger || function(){} // noop\n    this.longpollerTimeout    = opts.longpollerTimeout || 20000\n    this.params               = opts.params || {}\n    this.endPoint             = `${endPoint}/${TRANSPORTS.websocket}`\n    this.reconnectTimer       = new Timer(() => {\n      this.disconnect(() => this.connect())\n    }, this.reconnectAfterMs)\n  }\n\n  protocol(){ return location.protocol.match(/^https/) ? \"wss\" : \"ws\" }\n\n  endPointURL(){\n    let uri = Ajax.appendParams(\n      Ajax.appendParams(this.endPoint, this.params), {vsn: VSN})\n    if(uri.charAt(0) !== \"/\"){ return uri }\n    if(uri.charAt(1) === \"/\"){ return `${this.protocol()}:${uri}` }\n\n    return `${this.protocol()}://${location.host}${uri}`\n  }\n\n  disconnect(callback, code, reason){\n    if(this.conn){\n      this.conn.onclose = function(){} // noop\n      if(code){ this.conn.close(code, reason || \"\") } else { this.conn.close() }\n      this.conn = null\n    }\n    callback && callback()\n  }\n\n  // params - The params to send when connecting, for example `{user_id: userToken}`\n  connect(params){\n    if(params){\n      console && console.log(\"passing params to connect is deprecated. Instead pass :params to the Socket constructor\")\n      this.params = params\n    }\n    if(this.conn){ return }\n\n    this.conn = new this.transport(this.endPointURL())\n    this.conn.timeout   = this.longpollerTimeout\n    this.conn.onopen    = () => this.onConnOpen()\n    this.conn.onerror   = error => this.onConnError(error)\n    this.conn.onmessage = event => this.onConnMessage(event)\n    this.conn.onclose   = event => this.onConnClose(event)\n  }\n\n  // Logs the message. Override `this.logger` for specialized logging. noops by default\n  log(kind, msg, data){ this.logger(kind, msg, data) }\n\n  // Registers callbacks for connection state change events\n  //\n  // Examples\n  //\n  //    socket.onError(function(error){ alert(\"An error occurred\") })\n  //\n  onOpen     (callback){ this.stateChangeCallbacks.open.push(callback) }\n  onClose    (callback){ this.stateChangeCallbacks.close.push(callback) }\n  onError    (callback){ this.stateChangeCallbacks.error.push(callback) }\n  onMessage  (callback){ this.stateChangeCallbacks.message.push(callback) }\n\n  onConnOpen(){\n    this.log(\"transport\", `connected to ${this.endPointURL()}`, this.transport.prototype)\n    this.flushSendBuffer()\n    this.reconnectTimer.reset()\n    if(!this.conn.skipHeartbeat){\n      clearInterval(this.heartbeatTimer)\n      this.heartbeatTimer = setInterval(() => this.sendHeartbeat(), this.heartbeatIntervalMs)\n    }\n    this.stateChangeCallbacks.open.forEach( callback => callback() )\n  }\n\n  onConnClose(event){\n    this.log(\"transport\", \"close\", event)\n    this.triggerChanError()\n    clearInterval(this.heartbeatTimer)\n    this.reconnectTimer.scheduleTimeout()\n    this.stateChangeCallbacks.close.forEach( callback => callback(event) )\n  }\n\n  onConnError(error){\n    this.log(\"transport\", error)\n    this.triggerChanError()\n    this.stateChangeCallbacks.error.forEach( callback => callback(error) )\n  }\n\n  triggerChanError(){\n    this.channels.forEach( channel => channel.trigger(CHANNEL_EVENTS.error) )\n  }\n\n  connectionState(){\n    switch(this.conn && this.conn.readyState){\n      case SOCKET_STATES.connecting: return \"connecting\"\n      case SOCKET_STATES.open:       return \"open\"\n      case SOCKET_STATES.closing:    return \"closing\"\n      default:                       return \"closed\"\n    }\n  }\n\n  isConnected(){ return this.connectionState() === \"open\" }\n\n  remove(channel){\n    this.channels = this.channels.filter(c => c.joinRef() !== channel.joinRef())\n  }\n\n  channel(topic, chanParams = {}){\n    let chan = new Channel(topic, chanParams, this)\n    this.channels.push(chan)\n    return chan\n  }\n\n  push(data){\n    let {topic, event, payload, ref} = data\n    let callback = () => this.conn.send(JSON.stringify(data))\n    this.log(\"push\", `${topic} ${event} (${ref})`, payload)\n    if(this.isConnected()){\n      callback()\n    }\n    else {\n      this.sendBuffer.push(callback)\n    }\n  }\n\n  // Return the next message ref, accounting for overflows\n  makeRef(){\n    let newRef = this.ref + 1\n    if(newRef === this.ref){ this.ref = 0 } else { this.ref = newRef }\n\n    return this.ref.toString()\n  }\n\n  sendHeartbeat(){ if(!this.isConnected()){ return }\n    this.push({topic: \"phoenix\", event: \"heartbeat\", payload: {}, ref: this.makeRef()})\n  }\n\n  flushSendBuffer(){\n    if(this.isConnected() && this.sendBuffer.length > 0){\n      this.sendBuffer.forEach( callback => callback() )\n      this.sendBuffer = []\n    }\n  }\n\n  onConnMessage(rawMessage){\n    let msg = JSON.parse(rawMessage.data)\n    let {topic, event, payload, ref} = msg\n    this.log(\"receive\", `${payload.status || \"\"} ${topic} ${event} ${ref && \"(\" + ref + \")\" || \"\"}`, payload)\n    this.channels.filter( channel => channel.isMember(topic) )\n                 .forEach( channel => channel.trigger(event, payload, ref) )\n    this.stateChangeCallbacks.message.forEach( callback => callback(msg) )\n  }\n}\n\n\nexport class LongPoll {\n\n  constructor(endPoint){\n    this.endPoint        = null\n    this.token           = null\n    this.skipHeartbeat   = true\n    this.onopen          = function(){} // noop\n    this.onerror         = function(){} // noop\n    this.onmessage       = function(){} // noop\n    this.onclose         = function(){} // noop\n    this.pollEndpoint    = this.normalizeEndpoint(endPoint)\n    this.readyState      = SOCKET_STATES.connecting\n\n    this.poll()\n  }\n\n  normalizeEndpoint(endPoint){\n    return(endPoint\n      .replace(\"ws://\", \"http://\")\n      .replace(\"wss://\", \"https://\")\n      .replace(new RegExp(\"(.*)\\/\" + TRANSPORTS.websocket), \"$1/\" + TRANSPORTS.longpoll))\n  }\n\n  endpointURL(){\n    return Ajax.appendParams(this.pollEndpoint, {token: this.token})\n  }\n\n  closeAndRetry(){\n    this.close()\n    this.readyState = SOCKET_STATES.connecting\n  }\n\n  ontimeout(){\n    this.onerror(\"timeout\")\n    this.closeAndRetry()\n  }\n\n  poll(){\n    if(!(this.readyState === SOCKET_STATES.open || this.readyState === SOCKET_STATES.connecting)){ return }\n\n    Ajax.request(\"GET\", this.endpointURL(), \"application/json\", null, this.timeout, this.ontimeout.bind(this), (resp) => {\n      if(resp){\n        var {status, token, messages} = resp\n        this.token = token\n      } else{\n        var status = 0\n      }\n\n      switch(status){\n        case 200:\n          messages.forEach( msg => this.onmessage({data: JSON.stringify(msg)}) )\n          this.poll()\n          break\n        case 204:\n          this.poll()\n          break\n        case 410:\n          this.readyState = SOCKET_STATES.open\n          this.onopen()\n          this.poll()\n          break\n        case 0:\n        case 500:\n          this.onerror()\n          this.closeAndRetry()\n          break\n        default: throw(`unhandled poll status ${status}`)\n      }\n    })\n  }\n\n  send(body){\n    Ajax.request(\"POST\", this.endpointURL(), \"application/json\", body, this.timeout, this.onerror.bind(this, \"timeout\"), (resp) => {\n      if(!resp || resp.status !== 200){\n        this.onerror(status)\n        this.closeAndRetry()\n      }\n    })\n  }\n\n  close(code, reason){\n    this.readyState = SOCKET_STATES.closed\n    this.onclose()\n  }\n}\n\n\nexport class Ajax {\n\n  static request(method, endPoint, accept, body, timeout, ontimeout, callback){\n    if(window.XDomainRequest){\n      let req = new XDomainRequest() // IE8, IE9\n      this.xdomainRequest(req, method, endPoint, body, timeout, ontimeout, callback)\n    } else {\n      let req = window.XMLHttpRequest ?\n                  new XMLHttpRequest() : // IE7+, Firefox, Chrome, Opera, Safari\n                  new ActiveXObject(\"Microsoft.XMLHTTP\") // IE6, IE5\n      this.xhrRequest(req, method, endPoint, accept, body, timeout, ontimeout, callback)\n    }\n  }\n\n  static xdomainRequest(req, method, endPoint, body, timeout, ontimeout, callback){\n    req.timeout = timeout\n    req.open(method, endPoint)\n    req.onload = () => {\n      let response = this.parseJSON(req.responseText)\n      callback && callback(response)\n    }\n    if(ontimeout){ req.ontimeout = ontimeout }\n\n    // Work around bug in IE9 that requires an attached onprogress handler\n    req.onprogress = () => {}\n\n    req.send(body)\n  }\n\n  static xhrRequest(req, method, endPoint, accept, body, timeout, ontimeout, callback){\n    req.timeout = timeout\n    req.open(method, endPoint, true)\n    req.setRequestHeader(\"Content-Type\", accept)\n    req.onerror = () => { callback && callback(null) }\n    req.onreadystatechange = () => {\n      if(req.readyState === this.states.complete && callback){\n        let response = this.parseJSON(req.responseText)\n        callback(response)\n      }\n    }\n    if(ontimeout){ req.ontimeout = ontimeout }\n\n    req.send(body)\n  }\n\n  static parseJSON(resp){\n    return (resp && resp !== \"\") ?\n             JSON.parse(resp) :\n             null\n  }\n\n  static serialize(obj, parentKey){\n    let queryStr = [];\n    for(var key in obj){ if(!obj.hasOwnProperty(key)){ continue }\n      let paramKey = parentKey ? `${parentKey}[${key}]` : key\n      let paramVal = obj[key]\n      if(typeof paramVal === \"object\"){\n        queryStr.push(this.serialize(paramVal, paramKey))\n      } else {\n        queryStr.push(encodeURIComponent(paramKey) + \"=\" + encodeURIComponent(paramVal))\n      }\n    }\n    return queryStr.join(\"&\")\n  }\n\n  static appendParams(url, params){\n    if(Object.keys(params).length === 0){ return url }\n\n    let prefix = url.match(/\\?/) ? \"&\" : \"?\"\n    return `${url}${prefix}${this.serialize(params)}`\n  }\n}\n\nAjax.states = {complete: 4}\n\n\n\nexport var Presence = {\n\n  syncState(currentState, newState, onJoin, onLeave){\n    let state = this.clone(currentState)\n    let joins = {}\n    let leaves = {}\n\n    this.map(state, (key, presence) => {\n      if(!newState[key]){\n        leaves[key] = presence\n      }\n    })\n    this.map(newState, (key, newPresence) => {\n      let currentPresence = state[key]\n      if(currentPresence){\n        let newRefs = newPresence.metas.map(m => m.phx_ref)\n        let curRefs = currentPresence.metas.map(m => m.phx_ref)\n        let joinedMetas = newPresence.metas.filter(m => curRefs.indexOf(m.phx_ref) < 0)\n        let leftMetas = currentPresence.metas.filter(m => newRefs.indexOf(m.phx_ref) < 0)\n        if(joinedMetas.length > 0){\n          joins[key] = newPresence\n          joins[key].metas = joinedMetas\n        }\n        if(leftMetas.length > 0){\n          leaves[key] = this.clone(currentPresence)\n          leaves[key].metas = leftMetas\n        }\n      } else {\n        joins[key] = newPresence\n      }\n    })\n    return this.syncDiff(state, {joins: joins, leaves: leaves}, onJoin, onLeave)\n  },\n\n  syncDiff(currentState, {joins, leaves}, onJoin, onLeave){\n    let state = this.clone(currentState)\n    if(!onJoin){ onJoin = function(){} }\n    if(!onLeave){ onLeave = function(){} }\n\n    this.map(joins, (key, newPresence) => {\n      let currentPresence = state[key]\n      state[key] = newPresence\n      if(currentPresence){\n        state[key].metas.unshift(...currentPresence.metas)\n      }\n      onJoin(key, currentPresence, newPresence)\n    })\n    this.map(leaves, (key, leftPresence) => {\n      let currentPresence = state[key]\n      if(!currentPresence){ return }\n      let refsToRemove = leftPresence.metas.map(m => m.phx_ref)\n      currentPresence.metas = currentPresence.metas.filter(p => {\n        return refsToRemove.indexOf(p.phx_ref) < 0\n      })\n      onLeave(key, currentPresence, leftPresence)\n      if(currentPresence.metas.length === 0){\n        delete state[key]\n      }\n    })\n    return state\n  },\n\n  list(presences, chooser){\n    if(!chooser){ chooser = function(key, pres){ return pres } }\n\n    return this.map(presences, (key, presence) => {\n      return chooser(key, presence)\n    })\n  },\n\n  // private\n\n  map(obj, func){\n    return Object.getOwnPropertyNames(obj).map(key => func(key, obj[key]))\n  },\n\n  clone(obj){ return JSON.parse(JSON.stringify(obj)) }\n}\n\n\n// Creates a timer that accepts a `timerCalc` function to perform\n// calculated timeout retries, such as exponential backoff.\n//\n// ## Examples\n//\n//    let reconnectTimer = new Timer(() => this.connect(), function(tries){\n//      return [1000, 5000, 10000][tries - 1] || 10000\n//    })\n//    reconnectTimer.scheduleTimeout() // fires after 1000\n//    reconnectTimer.scheduleTimeout() // fires after 5000\n//    reconnectTimer.reset()\n//    reconnectTimer.scheduleTimeout() // fires after 1000\n//\nclass Timer {\n  constructor(callback, timerCalc){\n    this.callback  = callback\n    this.timerCalc = timerCalc\n    this.timer     = null\n    this.tries     = 0\n  }\n\n  reset(){\n    this.tries = 0\n    clearTimeout(this.timer)\n  }\n\n  // Cancels any previous scheduleTimeout and schedules callback\n  scheduleTimeout(){\n    clearTimeout(this.timer)\n\n    this.timer = setTimeout(() => {\n      this.tries = this.tries + 1\n      this.callback()\n    }, this.timerCalc(this.tries + 1))\n  }\n}\n","function isLinkToSubmitParent(element) {\n  var isLinkTag = element.tagName === 'A';\n  var shouldSubmitParent = element.getAttribute('data-submit') === 'parent';\n\n  return isLinkTag && shouldSubmitParent;\n}\n\nfunction didHandleSubmitLinkClick(element) {\n  while(element && element.getAttribute) {\n    if(isLinkToSubmitParent(element)) {\n      var message = element.getAttribute('data-confirm');\n      if (message === null || confirm(message)) {\n        element.parentNode.submit();\n      };\n      return true;\n    } else {\n      element = element.parentNode;\n    }\n  }\n  return false;\n}\n\n// for links with HTTP methods other than GET\nwindow.addEventListener('click', function (event) {\n  if(event.target && didHandleSubmitLinkClick(event.target)) {\n    event.preventDefault();\n    return false;\n  }\n}, false);\n","// Brunch automatically concatenates all files in your\n// watched paths. Those paths can be configured at\n// config.paths.watched in \"brunch-config.js\".\n//\n// However, those files will only be executed if\n// explicitly imported. The only exception are files\n// in vendor, which are never wrapped in imports and\n// therefore are always executed.\n\n// Import dependencies\n//\n// If you no longer want to use a dependency, remember\n// to also remove its path from \"config.paths.watched\".\nimport \"deps/phoenix_html/web/static/js/phoenix_html\"\n\n// Import local files\n//\n// Local files can be imported directly using relative\n// paths \"./socket\" or full ones \"web/static/js/socket\".\n\n/*\nimport socket from \"./socket\"\n\nsocket.connect()\n\nlet counter = 0;\n\n// Now that you are connected, you can join channels with a topic:\nlet channel = socket.channel(\"info:api\", {})\nchannel.join()\n  .receive(\"ok\", resp => { console.log(\"Joined successfully\") })\n  .receive(\"error\", resp => { console.log(\"Unable to join\", resp) });\n\nfunction process_users(users) {\n    if (users < 1) users = 1;\n    if (users == 1) {\n        $('#plural').html(\"\");\n    } else {\n        $('#plural').html(\"s\");\n    }\n    $(\"#users\").html(users.toString())\n}\n\nchannel.on(\"user:joined\",resp => {\n    var users = parseInt($(\"#users\").html(), 10);\n    process_users(users+1);\n});\n\nchannel.on(\"user:left\",resp => {\n    var users = parseInt($(\"#users\").html(), 10);\n    console.log(\"Someone left...\")\n    process_users(users-1);\n});\n\nchannel.on(\"new:message\",resp => {\n    var block = \"<div class='info-block row' style='display:none;'>\";\n    block += \"<div class='col-sm-1'><img height='58' src='images/theme_\" + resp.theme + \".jpg'></div>\";\n    block += \"<div class='col-sm-11 query'>\" + resp.query + \"</div>\";\n    block += \"</div>\";\n\n    var size = $('.info-block').size();\n    if ( size == 20 ) {\n        $('#info').find(\".info-block\").slice(19).remove();\n    }\n    $(block).hide().prependTo('#info').fadeIn();\n});\n*/","// NOTE: The contents of this file will only be executed if\n// you uncomment its entry in \"web/static/js/app.js\".\n\n// To use Phoenix channels, the first step is to import Socket\n// and connect at the socket path in \"lib/my_app/endpoint.ex\":\nimport {Socket} from \"deps/phoenix/web/static/js/phoenix\"\n\nlet socket = new Socket(\"/socket\")\n\n// When you connect, you'll often need to authenticate the client.\n// For example, imagine you have an authentication plug, `MyAuth`,\n// which authenticates the session and assigns a `:current_user`.\n// If the current user exists you can assign the user's token in\n// the connection for use in the layout.\n//\n// In your \"web/router.ex\":\n//\n//     pipeline :browser do\n//       ...\n//       plug MyAuth\n//       plug :put_user_token\n//     end\n//\n//     defp put_user_token(conn, _) do\n//       if current_user = conn.assigns[:current_user] do\n//         token = Phoenix.Token.sign(conn, \"user socket\", current_user.id)\n//         assign(conn, :user_token, token)\n//       else\n//         conn\n//       end\n//     end\n//\n// Now you need to pass this token to JavaScript. You can do so\n// inside a script tag in \"web/templates/layout/app.html.eex\":\n//\n//     <script>window.userToken = \"<%= assigns[:user_token] %>\";</script>\n//\n// You will need to verify the user token in the \"connect/2\" function\n// in \"web/channels/user_socket.ex\":\n//\n//     def connect(%{\"token\" => token}, socket) do\n//       # max_age: 1209600 is equivalent to two weeks in seconds\n//       case Phoenix.Token.verify(socket, \"user socket\", token, max_age: 1209600) do\n//         {:ok, user_id} ->\n//           {:ok, assign(socket, :user, user_id)}\n//         {:error, reason} ->\n//           :error\n//       end\n//     end\n//\n// Finally, pass the token on connect as below. Or remove it\n// from connect if you don't care about authentication.\n\n\nexport default socket\n"]}